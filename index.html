<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sanction Order Generator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 40px;
      line-height: 1.6;
    }
    h2 {
      text-align: center;
      text-decoration: underline;
    }
    .container {
      max-width: 900px;
      margin: auto;
    }
    .field {
      margin-bottom: 10px;
    }
    label {
      font-weight: bold;
    }
    input[type="text"], input[type="number"] {
      border: 1px solid #ccc;
      padding: 4px;
      width: 100%;
      margin-top: 4px;
    }
    .readonly {
      border: none;
      background: transparent;
      font-weight: bold;
    }
    .amount-table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
    }
    .amount-table th, .amount-table td {
      border: 1px solid #000;
      padding: 6px;
      text-align: left;
    }
    .signature {
      margin-top: 50px;
      text-align: right;
    }
    .buttons {
      margin: 20px 0;
      text-align: center;
    }
    .buttons button {
      padding: 10px 20px;
      margin: 5px;
      cursor: pointer;
    }
    @media print {
      .buttons, .field input[type="number"] {
        display: none;
      }
      input.readonly {
        border: none;
        background: transparent;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>SANCTION ORDER</h2>

    <div class="field">
      <label>Name of Work:</label>
      <span id="workName">Maintenance and Repair Work</span>
    </div>

    <div class="field">
      <label>Sanctioned Amount:</label>
      <span id="sanctionAmount"></span> 
      (<span id="sanctionAmountWords"></span>)
    </div>

    <div class="field">
      <label>Head of Account:</label>
      <input type="text" id="headOfAccount" placeholder="Enter Head of Account">
    </div>

    <div class="field">
      <label>Payee Name:</label>
      <span id="payeeName">M/s ABC Construction</span>
    </div>

    <table class="amount-table">
      <thead>
        <tr>
          <th>Particulars</th>
          <th>Amount (₹)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Gross Amount</td>
          <td><input type="number" id="grossAmount" value="0"></td>
        </tr>
        <tr>
          <td>Income Tax @ 2%</td>
          <td><span id="incomeTax"></span></td>
        </tr>
        <tr>
          <td>Security Deposit @ 10%</td>
          <td><span id="sd"></span></td>
        </tr>
        <tr>
          <td>Labour Cess @ 1%</td>
          <td><span id="labourCess"></span></td>
        </tr>
        <tr>
          <td>GST @ 12%</td>
          <td><span id="gst"></span></td>
        </tr>
        <tr>
          <td>Time Extension Penalty</td>
          <td><input type="number" id="timeExtension" value="0"></td>
        </tr>
        <tr>
          <td>Road Roller Charges</td>
          <td><input type="number" id="roadRoller" value="0"></td>
        </tr>
        <tr>
          <td>Bitumen Drum Charges</td>
          <td><input type="number" id="bitumenDrum" value="0"></td>
        </tr>
        <tr>
          <th>Net Amount Payable</th>
          <th><span id="netAmount"></span></th>
        </tr>
        <tr>
          <td colspan="2">In Words: <span id="amountInWords"></span></td>
        </tr>
      </tbody>
    </table>

    <div class="signature">
      <input type="text" class="readonly" value="Sajal Biswas, Deputy Secretary">
    </div>

    <div class="field">
      <label>Copy to:</label>
      <span>The Treasury Officer</span>
    </div>

    <div class="buttons">
      <button id="previewBtn">Preview</button>
      <button id="printBtn">Print</button>
    </div>
  </div>

  <script>
    function formatCurrency(num) {
      return "₹" + num.toLocaleString("en-IN");
    }

    function numberToWords(num) {
      const a = ["", "One", "Two", "Three", "Four", "Five", "Six", "Seven", "Eight", "Nine", "Ten",
        "Eleven", "Twelve", "Thirteen", "Fourteen", "Fifteen", "Sixteen", "Seventeen", "Eighteen", "Nineteen"];
      const b = ["", "", "Twenty", "Thirty", "Forty", "Fifty", "Sixty", "Seventy", "Eighty", "Ninety"];

      if ((num = num.toString()).length > 9) return "Overflow";
      let n = ("000000000" + num).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);
      if (!n) return; 
      let str = "";
      str += (n[1] != 0) ? (a[Number(n[1])] || b[n[1][0]] + " " + a[n[1][1]]) + " Crore " : "";
      str += (n[2] != 0) ? (a[Number(n[2])] || b[n[2][0]] + " " + a[n[2][1]]) + " Lakh " : "";
      str += (n[3] != 0) ? (a[Number(n[3])] || b[n[3][0]] + " " + a[n[3][1]]) + " Thousand " : "";
      str += (n[4] != 0) ? (a[Number(n[4])] || b[n[4][0]] + " " + a[n[4][1]]) + " Hundred " : "";
      str += (n[5] != 0) ? ((str != "") ? "and " : "") + (a[Number(n[5])] || b[n[5][0]] + " " + a[n[5][1]]) + " " : "";
      return str.trim() + " Only";
    }

    function updateCalculations() {
      let gross = parseFloat(document.getElementById('grossAmount').value) || 0;
      let timeExtension = parseFloat(document.getElementById('timeExtension').value) || 0;
      let roadRoller = parseFloat(document.getElementById('roadRoller').value) || 0;
      let bitumenDrum = parseFloat(document.getElementById('bitumenDrum').value) || 0;

      let incomeTax = Math.round(gross * 0.02);
      let sd = Math.round(gross * 0.10);
      let labourCess = Math.round(gross * 0.01);
      let gst = Math.round(gross * 0.12);

      let netAmount = Math.round(gross - incomeTax - sd - labourCess - gst - timeExtension - roadRoller - bitumenDrum);

      document.getElementById('sanctionAmount').innerText = formatCurrency(gross);
      document.getElementById('sanctionAmountWords').innerText = numberToWords(gross);
      document.getElementById('incomeTax').innerText = formatCurrency(incomeTax);
      document.getElementById('sd').innerText = formatCurrency(sd);
      document.getElementById('labourCess').innerText = formatCurrency(labourCess);
      document.getElementById('gst').innerText = formatCurrency(gst);
      document.getElementById('netAmount').innerText = formatCurrency(netAmount);
      document.getElementById('amountInWords').innerText = numberToWords(netAmount);
    }

    document.querySelectorAll('#grossAmount, #timeExtension, #roadRoller, #bitumenDrum')
      .forEach(el => el.addEventListener('input', updateCalculations));

    document.getElementById('printBtn').addEventListener('click', () => window.print());
    document.getElementById('previewBtn').addEventListener('click', () => window.print());

    updateCalculations();
  </script>
</body>
</html>
