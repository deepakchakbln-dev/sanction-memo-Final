<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sanction Memo Software</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        body {
            margin: 0;
            padding: 20px;
            background-color: #f0f2f5;
            color: #333;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background-color: white;
            padding: 25px;
            box-shadow: 0 0 15px rgba(0,0,0,0.1);
            border-radius: 5px;
        }
        .header {
            text-align: center;
            margin-bottom: 25px;
            border-bottom: 2px solid #2c3e50;
            padding-bottom: 15px;
        }
        .header h1 {
            margin: 0;
            font-size: 22px;
            color: #2c3e50;
        }
        .header p {
            margin: 3px 0;
            font-size: 13px;
        }
        .memo-info {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 13px;
        }
        .memo-info div {
            text-align: left;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            font-size: 13px;
            color: #2c3e50;
        }
        input, select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 13px;
        }
        input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 3px rgba(52, 152, 219, 0.3);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 13px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        .formula-section {
            background-color: #f9f9f9;
            padding: 12px;
            border-radius: 5px;
            margin: 15px 0;
            border-left: 4px solid #3498db;
        }
        .formula-item {
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }
        .formula-item label {
            width: 180px;
            margin-bottom: 0;
        }
        .formula-item input {
            width: 90px;
            margin-left: 10px;
        }
        .formula-controls {
            display: flex;
            gap: 8px;
            margin-top: 15px;
        }
        button {
            padding: 8px 12px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #2980b9;
        }
        .result {
            font-weight: bold;
            background-color: #e9f7e9;
            padding: 10px;
            border-radius: 4px;
            margin-top: 8px;
            border-left: 4px solid #2ecc71;
            font-size: 13px;
        }
        .footer {
            margin-top: 15px;
            display: flex;
            justify-content: space-between;
        }
        .signature {
            text-align: center;
        }
        .signature p {
            margin: 3px 0;
            font-size: 13px;
        }
        .controls {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
        }
        .print-only {
            display: none;
        }
        .sanction-text {
            font-size: 13px;
            margin-bottom: 15px;
            text-align: justify;
            line-height: 1.4;
        }
        .editable-amount {
            width: 120px;
            display: inline-block;
        }
        
        @media print {
            body {
                background-color: white;
                padding: 0;
                margin: 0;
                font-size: 12px;
            }
            .container {
                box-shadow: none;
                padding: 15px;
                max-width: 100%;
            }
            .formula-section, .formula-controls, button, .no-print {
                display: none !important;
            }
            .print-only {
                display: block;
            }
            table {
                page-break-inside: avoid;
                font-size: 12px;
            }
            .header h1 {
                font-size: 18px;
            }
            .header p, .memo-info, .sanction-text, .signature p {
                font-size: 11px;
            }
            th, td {
                padding: 6px;
            }
            .editable-amount {
                display: none;
            }
            .amount-value {
                display: inline;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <p>GOVERNMENT OF TRIPURA</p>
            <p>OFFICE OF THE EXECUTIVE ENGINEER</p>
            <p>BELONIA DIVISION, PWD(R&B)</p>
            <p>BELONIA, SOUTH TRIPURA</p>
            
            <div class="memo-info">
                <div>
                    <strong>Sanction Memo No:</strong> F.5(11)/EE(PWD)/R&B/BLN/DIVN/
                    <input type="text" id="memoSuffix" placeholder="Suffix" style="width: 80px; display: inline;">
                </div>
                <div>
                    <strong>Dated:</strong> <input type="date" id="memoDate" style="width: 150px; display: inline;">
                </div>
            </div>
        </div>

        <h2 style="font-size: 16px; margin-bottom: 10px;">Sanction Memo</h2>
        
        <div class="sanction-text">
            Expenditure sanction is hereby accorded not exceeding an amount of Rs. <span id="sanctionAmountText">10,00,000</span>/----- (Rupees <span id="sanctionAmountWords">Ten Lakh</span>) Only hereby accorded to drawn in Fully Voucher Bill bearing the cost for the work.
        </div>
        
        <div class="form-group">
            <label for="workName">Name of Work:</label>
            <input type="text" id="workName" value="FDR / Nto. Of different roads under Rajnagar Sub-Division">
        </div>

        <div class="form-group no-print">
            <label for="grossAmount">Gross Amount (₹):</label>
            <input type="number" id="grossAmount" value="1000000" min="0" step="1000">
        </div>

        <div class="formula-section no-print">
            <h3 style="font-size: 14px; margin-top: 0;">Deduction Formulas</h3>
            <div class="formula-item">
                <label for="incomeTaxRate">Income Tax Rate (%):</label>
                <input type="number" id="incomeTaxRate" value="0.8475" min="0" max="100" step="0.0001">
            </div>
            <div class="formula-item">
                <label for="sdRate">SD Rate (%):</label>
                <input type="number" id="sdRate" value="2.5" min="0" max="100" step="0.1">
            </div>
            <div class="formula-item">
                <label for="labourCessRate">Labour Cess Rate (%):</label>
                <input type="number" id="labourCessRate" value="1" min="0" max="100" step="0.1">
            </div>
            <div class="formula-item">
                <label for="gstRate">GST Rate (CGST + SGST) (%):</label>
                <input type="number" id="gstRate" value="2" min="0" max="100" step="0.1">
            </div>
            <div class="formula-controls">
                <button id="updateFormulas">Update Formulas</button>
                <button id="resetFormulas">Reset to Default</button>
            </div>
        </div>

        <table>
            <thead>
                <tr>
                    <th width="8%">Sl. No.</th>
                    <th width="62%">Particulars</th>
                    <th width="30%">Amount (in ₹)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td>Sanction this memo</td>
                    <td id="sanctionAmount">₹10,00,000.00</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>Less Income Tax (-)</td>
                    <td id="incomeTax">₹8,475.00</td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>Less SD (-)</td>
                    <td id="sd">₹25,000.00</td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>Less Labour Cess, Beneficiary ID-194646 (-)</td>
                    <td id="labourCess">₹10,000.00</td>
                </tr>
                <tr>
                    <td>5</td>
                    <td>Less: GST (CGST+SGST) (-)</td>
                    <td id="gst">₹16,950.00</td>
                </tr>
                <tr>
                    <td>6</td>
                    <td>Less: Time Extension Leavy
                        <input type="number" id="timeExtension" class="editable-amount" value="0" min="0" step="100">
                        <span class="amount-value">₹0.00</span>
                    </td>
                    <td id="timeExtensionAmount">₹0.00</td>
                </tr>
                <tr>
                    <td>7</td>
                    <td>Less: Road Roller
                        <input type="number" id="roadRoller" class="editable-amount" value="0" min="0" step="100">
                        <span class="amount-value">₹0.00</span>
                    </td>
                    <td id="roadRollerAmount">₹0.00</td>
                </tr>
                <tr>
                    <td>8</td>
                    <td>Less: Bitumen Drum
                        <input type="number" id="bitumenDrum" class="editable-amount" value="0" min="0" step="100">
                        <span class="amount-value">₹0.00</span>
                    </td>
                    <td id="bitumenDrumAmount">₹0.00</td>
                </tr>
                <tr>
                    <td>9</td>
                    <td>Payee: <input type="text" id="payeeName" value="Sajal Biswas" style="width: 200px; display: inline;"></td>
                    <td id="netAmount">₹9,39,575.00</td>
                </tr>
            </tbody>
        </table>

        <div class="result">
            <p id="amountInWords">Rupees Nine Lakh Thirty Nine Thousand Five Hundred Seventy Five Only</p>
        </div>

        <div class="form-group">
            <label for="fundSource">The Expenditure will be made out of the total fund received from the</label>
            <input type="text" id="fundSource" value="Deputy Secretary, PWD(R&B), Vide memo No. F. 1022/PV/Q1(BSA)/2025. Dated, 12.08.2025">
        </div>

        <div class="form-group">
            <label for="accountHead">The Expenditure involved on this account will be debatable to the Head of Account:</label>
            <input type="text" id="accountHead" placeholder="Enter Head of Account details">
        </div>

        <div class="footer">
            <div class="signature">
                <p>(Er. Litan Debnath)</p>
                <p>Executive Engineer</p>
                <p>Belonia Division, PWD(R&B)</p>
                <p>Belonia, South Tripura</p>
            </div>
        </div>

        <div class="form-group">
            <label for="copyTo">Copy to:</label>
            <input type="text" id="copyTo" value="The Treasury Officer, Belonia Treasury for kind information please.">
        </div>

        <div class="controls no-print">
            <button id="printBtn">Print Sanction Memo</button>
            <button id="saveBtn">Save Data</button>
            <button id="clearBtn">Clear Form</button>
            <button id="previewBtn">Print Preview</button>
        </div>
    </div>

    <script>
        function formatCurrency(amount) {
            return '₹' + new Intl.NumberFormat('en-IN', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(amount);
        }

        function formatNumber(amount) {
            return new Intl.NumberFormat('en-IN', {
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount);
        }

        function numberToWords(num) {
            const ones = ['', 'One', 'Two', 'Three', 'Four', 'Five', 'Six', 'Seven', 'Eight', 'Nine', 'Ten', 
                         'Eleven', 'Twelve', 'Thirteen', 'Fourteen', 'Fifteen', 'Sixteen', 'Seventeen', 'Eighteen', 'Nineteen'];
            const tens = ['', '', 'Twenty', 'Thirty', 'Forty', 'Fifty', 'Sixty', 'Seventy', 'Eighty', 'Ninety'];
            
            if (num === 0) return 'Zero';
            
            function convertLessThanThousand(n) {
                if (n === 0) return '';
                else if (n < 20) return ones[n] + ' ';
                else if (n < 100) return tens[Math.floor(n / 10)] + ' ' + ones[n % 10] + ' ';
                else return ones[Math.floor(n / 100)] + ' Hundred ' + convertLessThanThousand(n % 100);
            }
            
            function convert(n) {
                if (n < 10000000) {
                    if (n < 1000) return convertLessThanThousand(n);
                    else if (n < 100000) {
                        return convertLessThanThousand(Math.floor(n / 1000)) + 'Thousand ' + convertLessThanThousand(n % 1000);
                    } else {
                        return convertLessThanThousand(Math.floor(n / 100000)) + 'Lakh ' + convert(Math.floor(n % 100000));
                    }
                }
                return 'Number too large';
            }
            
            let result = convert(Math.floor(num)) + 'Only';
            return 'Rupees ' + result.charAt(0).toUpperCase() + result.slice(1);
        }

        function numberToWordsSanction(num) {
            const ones = ['', 'One', 'Two', 'Three', 'Four', 'Five', 'Six', 'Seven', 'Eight', 'Nine', 'Ten', 
                         'Eleven', 'Twelve', 'Thirteen', 'Fourteen', 'Fifteen', 'Sixteen', 'Seventeen', 'Eighteen', 'Nineteen'];
            const tens = ['', '', 'Twenty', 'Thirty', 'Forty', 'Fifty', 'Sixty', 'Seventy', 'Eighty', 'Ninety'];
            
            if (num === 0) return 'Zero';
            
            function convertLessThanThousand(n) {
                if (n === 0) return '';
                else if (n < 20) return ones[n] + ' ';
                else if (n < 100) return tens[Math.floor(n / 10)] + ' ' + ones[n % 10] + ' ';
                else return ones[Math.floor(n / 100)] + ' Hundred ' + convertLessThanThousand(n % 100);
            }
            
            function convert(n) {
                if (n < 10000000) {
                    if (n < 1000) return convertLessThanThousand(n);
                    else if (n < 100000) {
                        return convertLessThanThousand(Math.floor(n / 1000)) + 'Thousand ' + convertLessThanThousand(n % 1000);
                    } else {
                        return convertLessThanThousand(Math.floor(n / 100000)) + 'Lakh ' + convert(Math.floor(n % 100000));
                    }
                }
                return 'Number too large';
            }
            
            let result = convert(Math.floor(num));
            return result.charAt(0).toUpperCase() + result.slice(1);
        }

        function calculateValues() {
            const grossAmount = parseFloat(document.getElementById('grossAmount').value) || 0;
            const incomeTaxRate = parseFloat(document.getElementById('incomeTaxRate').value) || 0;
            const sdRate = parseFloat(document.getElementById('sdRate').value) || 0;
            const labourCessRate = parseFloat(document.getElementById('labourCessRate').value) || 0;
            const gstRate = parseFloat(document.getElementById('gstRate').value) || 0;
            
            const timeExtension = parseFloat(document.getElementById('timeExtension').value) || 0;
            const roadRoller = parseFloat(document.getElementById('roadRoller').value) || 0;
            const bitumenDrum = parseFloat(document.getElementById('bitumenDrum').value) || 0;
            
            const incomeTax = grossAmount * incomeTaxRate / 100;
            const sd = grossAmount * sdRate / 100;
            const labourCess = grossAmount * labourCessRate / 100;
            const gst = grossAmount * gstRate / 100;
            
            const netAmount = grossAmount - incomeTax - sd - labourCess - gst - timeExtension - roadRoller - bitumenDrum;
            
            document.getElementById('sanctionAmount').textContent = formatCurrency(grossAmount);
            document.getElementById('incomeTax').textContent = formatCurrency(incomeTax);
            document.getElementById('sd').textContent = formatCurrency(sd);
            document.getElementById('labourCess').textContent = formatCurrency(labourCess);
            document.getElementById('gst').textContent = formatCurrency(gst);
            
            document.getElementById('timeExtensionAmount').textContent = formatCurrency(timeExtension);
            document.getElementById('roadRollerAmount').textContent = formatCurrency(roadRoller);
            document.getElementById('bitumenDrumAmount').textContent = formatCurrency(bitumenDrum);
            
            document.querySelectorAll('.amount-value')[0].textContent = formatCurrency(timeExtension);
            document.querySelectorAll('.amount-value')[1].textContent = formatCurrency(roadRoller);
            document.querySelectorAll('.amount-value')[2].textContent = formatCurrency(bitumenDrum);
            
            document.getElementById('netAmount').textContent = formatCurrency(netAmount);
            
            document.getElementById('sanctionAmountText').textContent = formatNumber(grossAmount);
            document.getElementById('sanctionAmountWords').textContent = numberToWordsSanction(grossAmount);
            
            document.getElementById('amountInWords').textContent = numberToWords(netAmount);
        }

        document.getElementById('memoDate').valueAsDate = new Date();

        document.getElementById('grossAmount').addEventListener('input', calculateValues);
        document.getElementById('updateFormulas').addEventListener('click', calculateValues);
        
        document.getElementById('timeExtension').addEventListener('input', calculateValues);
        document.getElementById('roadRoller').addEventListener('input', calculateValues);
        document.getElementById('bitumenDrum').addEventListener('input', calculateValues);
        
        document.getElementById('resetFormulas').addEventListener('click', function() {
            document.getElementById('incomeTaxRate').value = 0.8475;
            document.getElementById('sdRate').value = 2.5;
            document.getElementById('labourCessRate').value = 1;
            document.getElementById('gstRate').value = 2;
            document.getElementById('timeExtension').value = 0;
            document.getElementById('roadRoller').value = 0;
            document.getElementById('bitumenDrum').value = 0;
            calculateValues();
        });

        document.getElementById('printBtn').addEventListener('click', function() {
            window.print();
        });

        document.getElementById('previewBtn').addEventListener('click', function() {
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                <head>
                    <title>Sanction Memo Print Preview</title>
                    <style>
                        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 15px; font-size: 12px; }
                        .container { max-width: 100%; }
                        .header { text-align: center; margin-bottom: 15px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px; }
                        .header h1 { margin: 0; font-size: 18px; color: #2c3e50; }
                        .header p { margin: 2px 0; font-size: 11px; }
                        .memo-info { display: flex; justify-content: space-between; margin-top: 8px; font-size: 11px; }
                        table { width: 100%; border-collapse: collapse; margin: 10px 0; font-size: 11px; }
                        th, td { border: 1px solid #ddd; padding: 6px; text-align: left; }
                        th { background-color: #f2f2f2; font-weight: bold; }
                        .result { font-weight: bold; background-color: #e9f7e9; padding: 8px; border-radius: 4px; margin-top: 8px; border-left: 4px solid #2ecc71; font-size: 11px; }
                        .sanction-text { font-size: 11px; margin-bottom: 10px; text-align: justify; line-height: 1.4; }
                        .footer { margin-top: 10px; }
                        .signature { text-align: center; }
                        .signature p { margin: 2px 0; font-size: 11px; }
                        .editable-amount { display: none; }
                        .amount-value { display: inline; }
                    </style>
                </head>
                <body>
                    <div class="container">
                        ${document.querySelector('.container').innerHTML}
                    </div>
                </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.focus();
        });

        document.getElementById('saveBtn').addEventListener('click', function() {
            alert('Data saved successfully!');
        });

        document.getElementById('clearBtn').addEventListener('click', function() {
            if (confirm('Are you sure you want to clear the form?')) {
                document.getElementById('grossAmount').value = '';
                document.getElementById('payeeName').value = '';
                document.getElementById('memoSuffix').value = '';
                document.getElementById('accountHead').value = '';
                document.getElementById('timeExtension').value = 0;
                document.getElementById('roadRoller').value = 0;
                document.getElementById('bitumenDrum').value = 0;
                calculateValues();
            }
        });

        calculateValues();
    </script>
</body>
</html>
